{{ define "main" }}
{{ $isBlogPost := eq .Section "blog" }}
<article{{ if $isBlogPost }} class="blog-post"{{ end }}>
    <header>
        {{ if $isBlogPost }}
        <div class="post-meta">
            <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
            <span class="reading-time">{{ math.Round (div (countwords .Content) 200.0) }} min read</span>
        </div>
        {{ end }}
        <h1>{{ .Title }}</h1>
        {{ with .Params.tags }}
        <div class="tags">
            {{ range . }}<a href="/tags/{{ . | urlize }}/" class="tag">{{ . }}</a>{{ end }}
        </div>
        {{ end }}
    </header>
    <div class="content">
        {{ .Content }}
    </div>

    {{ if $isBlogPost }}
    {{ $related := .Site.RegularPages.Related . | first 3 }}
    {{ with $related }}
    <div class="related-posts">
        <h3>Related Posts</h3>
        <ul>
            {{ range . }}
            <li><a href="{{ .Permalink }}">{{ .Title }}</a></li>
            {{ end }}
        </ul>
    </div>
    {{ end }}

    <footer class="post-footer">
        <a href="/blog/">‚Üê All posts</a>
    </footer>
    {{ end }}
</article>
{{ end }}
